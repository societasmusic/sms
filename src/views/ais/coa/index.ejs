<%- include('../../partials/header') %>
<div class="flex-grow-1 bg-body">
    <%- include('../../partials/breadcrumb') %>
    <div class="bg-body border-bottom px-3 py-2">
        <div class="px-3 container-fluid d-flex justify-content-between">
            <div class="d-flex" role="group" aria-label="Basic example">
                <button class="btn btn-outline-secondary rounded-0 rounded-start py-0 px-3 fs-7" onclick="location.href='/ais/coa/export/csv'">Export CSV</button>
                <button class="btn btn-outline-secondary rounded-0 rounded-end border-start-0 py-0 px-3 fs-7" onclick="location.href='/ais/coa/export/xml'">Export XML</button>
                <% if (user.access ==  "Editor" || user.access ==  "System Administrator" || user.access ==  "System Owner") { %>
                    <button type="button" class="btn btn-outline-secondary fs-7 py-1 px-2 d-flex ms-2" data-bs-toggle="tooltip" data-bs-title="Create account" onclick="location.href='/ais/coa/create'">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg d-flex align-self-center me-1" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2"/>
                        </svg>
                        Add
                    </button>
                <% } %>
            </div>
        </div>
    </div>
    <div class="pt-2 pb-3 bg-body">
        <div class="px-3">
            <div class="px-3 container-fluid d-flex justify-content-between">
                <div class="d-flex justify-content-between gap-3">
                    <form action="/ais/coa/search" method="GET">
                        <input type="search" class="form-control fs-7" placeholder="Search records..." aria-label="Search" name="q" id="q" style="width: 275px;">
                    </form>
                    <div>
                        <ul class="list-group">
                            <li class="input-group-text bg-body text-secondary fs-7">
                                <% let startRecord = (Number(current) - 1) * perPage + 1; %>
                                <% let endRecord = Math.min(startRecord + perPage - 1, count); %>
                                <%= `${startRecord}-${endRecord}` %>
                                <%= `of ${count} Records` %>
                            </li>
                        </ul>
                    </div>
                </div>
                <nav aria-label="Page navigation">
                    <ul class="pagination mb-0">
                        <% if (accounts > 0) { %>                                 
                            <% if (current == 1) { %>
                                <li class="page-item disabled"><a class="page-link fs-7" href="">&laquo;</a></li>
                            <% } else { %>
                                <li class="page-item"><a class="page-link fs-7" href="?p=1">&laquo;</a></li>
                            <% } %>
                            <% if (current == 1) { %>
                                <li class="page-item disabled"><a class="page-link fs-7" href="">&lsaquo;</a></li>
                            <% } else { %>
                                <li class="page-item"><a class="page-link fs-7" href="?p=<%= current - 1 %>">&lsaquo;</a></li>
                            <% } %>
                            <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
                            <% if (i !== 1) { %>
                                <li class="page-item disabled"><a class="page-link fs-7" href="">...</a></li>
                            <% } %>
                            <% for(; i <= (Number(current) + 4) && i <= pages; i++) { %>
                                <% if (i == current) { %>
                                    <li class="page-item disabled"><a class="page-link fs-7" href=""><%= i %></a></li>
                                <% } else { %>
                                    <li class="page-item"><a class="page-link fs-7" href="?p=<%= i %>"><%= i %></a></li>
                                <% } %>
                                <% if (i == Number(current) + 4 && i < pages) { %>
                                    <li class="page-item disabled"><a class="page-link fs-7" href="">...</a></li>
                                <% } %>
                            <% } %>
                            <% if (current == pages) { %>
                                <li class="page-item disabled"><a class="page-link fs-7" href="">&rsaquo;</a></li>
                            <% } else { %>
                                <li class="page-item"><a class="page-link fs-7" href="?p=<%= Number(current) + 1 %>">&rsaquo;</a></li>
                            <% } %>
                            <% if (current == pages) { %>
                                <li class="page-item disabled"><a class="page-link fs-7" href="">&raquo;</a></li>
                            <% } else { %>
                                <li class="page-item"><a class="page-link fs-7" href="?p=<%= pages %>">&raquo;</a></li>
                            <% } %>
                        <% } else { %>
                            <li class="page-item disabled"><a class="page-link fs-7" href="">&laquo;</a></li>
                            <li class="page-item disabled"><a class="page-link fs-7" href="">&lsaquo;</a></li>
                            <li class="page-item disabled"><a class="page-link fs-7" href="">1</a></li>
                            <li class="page-item disabled"><a class="page-link fs-7" href="">&rsaquo;</a></li>
                            <li class="page-item disabled"><a class="page-link fs-7" href="">&raquo;</a></li>
                        <% } %>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="px-3 container-fluid border-top mt-2">
            <p class="fs-7 px-3 pt-2 mb-2 text-secondary">Search Results</p>
            <div class="px-3">
                <table class="fs-7 table">
                    <thead>
                        <tr>
                            <th class="col-1 text-secondary fw-medium">
                                #
                            </th>
                            <th class="col-2 text-secondary fw-medium">
                                Account Type
                            </th>
                            <th class="col-6 text-secondary fw-medium">
                                Name
                            </th>
                            <th class="col-2 text-secondary fw-medium">
                                Balance
                            </th>
                            <th class="col-1 text-secondary fw-medium">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <% const type = [{num:1100,name:"Current Assets"},{num:1200,name:"Non-Current Assets"},{num:2100,name:"Current Liabilities"},{num:2200,name:"Non-Current Liabilities"},{num:3000,name:"Equity"},{num:4000,name:"Revenue"},{num:5000,name:"Expenses"}] %>
                        <% if (accounts) { %>
                            <% accounts.forEach(e => { %>
                                <% i = 1 %>
                                <tr>
                                    <td class="py-3"><%= e.number %></td>
                                    <td class="py-3">
                                        <% typeFound = type.find((obj) => obj.num === Number(e.type)) %>
                                        <%= `${e.type} / ${typeFound.name}` %>
                                    </td>
                                    <td class="py-3"><%= e.name %></td>
                                    <td class="py-3">0.00 USD</td>
                                    <td class="py-3">
                                       <a href="/ais/coa/<%= e.number %>">Manage</a>
                                    </td>
                                </tr>
                                <% i = i++ %>
                            <% }) %>
                        <% } else { %>
                            <tr>
                                <td class="py-3">...</td>
                                <td class="py-3">...</td>
                                <td class="py-3">...</td>
                                <td class="py-3">...</td>
                                <td class="py-3">...</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<%- include('../../partials/footer') %>